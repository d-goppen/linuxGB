#!/bin/bash
# 1 Просмотреть содержимое директорий /etc, /proc, /home.
#   Посмотреть содержимое пары произвольных файлов в /etc.
#-> Там, где в выводе много строк, использую less для просмотра
ls -l /etc | less
ls -l /proc | less
ls -l /home
#-> Использую less, т.к. в отличие от cat позволяет перемещаться по содержимому файла
less /etc/adduser.conf
less /etc/deluser.conf

# 2 Выяснить, для чего предназначена команда cat.
#   Используя только данную команду и потоки ввода-вывода:
# - создайте два файла с данными, а затем объедините их в один.
cat 1>~/file_1
cat 1>~/file_2
cat ~/file_1 ~/file_2 1>file_3
# - просмотрите содержимое созданного файла.
cat ~/file3
# - скопируйте файл, дав ему новое имя.
cp ~/file_3 ~/file_third

# 3 Создать 3 новых файла 3-мя разными способами.
touch ~/the_file_1
cat 1>~/the_file_2 # Тут надо ручками что-нибудь ввести.
echo 'Here is the third file...' > ~/the_file_3
#   Создайте директорию, переместите файл туда.
mkdir ~/the_dir
#   Удалите все созданные в этом и предыдущем задании директории и файлы.
#-> С учтом того, что в этом и предыдущем заданиях в именах всех файлов содержится file,
#-> следующая команда переносит в каталог the_dir все файлы, созданные в заданиях 2 и 3.
mv ~/*file* ~/the_dir
rm -r ~/the_dir

# 4 В ОС Linux скрытыми файлами считаются те, имена которых начинаются с символа точки ..
#   Напишите команду, которая будет показывать количество скрытых файлов в домашнем каталоге пользоватедя.
#   Использовать конвейер (пайплайн). Подсказка: для подсчета количества строк можно использовать wc).
ls -ad ~/.* | ws -l

# 5 Попробовать вывести с помощью команды cat содержимое всех файлов в директории /etc,
#   перенаправив вывод в любой файл в директории /tmp, а ошибки в отдельный файл в домашнем каталоге.
#   Использовать вайлдкарты. Сколько файлов, которые не удалось посмотреть, оказалось в списке?
cat /etc/* 1>/tmp/cat.log 2>~/cat.error
#-> Количество ошибок верно лишь для моего случая.
cat ~/cat.error | wc -l              # 96 = Всего ошибок при выводе файлов из /etc
grep 'Is a directory' ~/cat.error    # 90 = Ошибок 'Is a directory'
grep 'Permission denied' ~/cat.error # 6 = Ошибок 'Permission denied'

# 6 Используя справку команды ps, разберитесь как вывести информацию о процессах в древовидной форме,
ps -AH   # Все процессы. Иерархия в виде сдвига имени процесса вправо.
ps -A f  # Все процессы. Иерархия в виде дорисованного ASCCI-дерева.
#   как вывести процессы, запущенные только пользователем gdm,
ps -U gdm
#   как узнать PID процесса.
#-> PID процесса указан в первой колонке вывода
#-> Если нам нужен только PID процесса, например systemd-journal
pgrep systemd-journal
pidof less

# 7 Прочитать в методическом пособии о сигналах.
#   Запустить в одном терминале любую программу, например vim.
#   В другом терминале посмотреть PID процесса (используйте) и остановить с помощью kill,
#   посылая разные типы сигналов (SIGHUP, SIGTERM, SIGSEGV, SIGKILL).
#   Чем отличается заверщение программы в зависимости от сигнала?
#-> SIGHUP  = Отключает дочерний процесс от родительского. Используется для перезапуска процесса.
#-> SIGTERM = "Просит" процесс завершится. Есть время для корректного завершения. Может игнорироваться.
#-> SIGSEGV = Принудительное завершение процесса с дампом памяти (ошибка сегментации / доступа к памяти).
#-> SIGKILL = Принудительное немедленное завершение процесса. (Бритвой по горлу и в колодец. (C) "Джентльмены удачи")

# 8*Отобразить в /dev список устройств, которые в настоящее время используются вашим UID
#   (для этого используется команда lsof). Организовать конвейер через less, чтобы посмотреть их должным образом.
lsoff -u prospere /dev

# 9*Cоздайте директорию для хранения фотографий, в ней должны быть директории по годам,
#   (например, за последние 5 лет), и в каждой директории года по директории для месяца.
mkdir -p ~/{2016..2020}/{01..12}

#10*Заполните директории файлами вида ГГГГММДДНН.txt. Внутри файла должно быть имя файла.
#   Например 2018011301.txt, 2018011302.txt.


#11*Полезное задание на конвейер.
#   Использовать команду cut на вывод длинного списка каталога, чтобы отобразить только права доступа к файлам.
#   Затем отправить в конвейере этот вывод на sort и uniq, чтобы отфильтровать все повторяющиеся строки.
#   Потом с помощью wc посчитать различные типы разрешений в этом каталоге.
#   Самостоятельно решить задачу, как сделать так, чтобы в подсчет не добавлялись строка Итого и файлы . и ..
#   (ссылки на текущую и родительскую директории)